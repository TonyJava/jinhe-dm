<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8" />
	<title>看板</title>

	<script type="text/javascript" src="framework/core.js"></script>
	<script type="text/javascript" src="framework/ajax.js"></script>
	<script type="text/javascript" src="ichartjs/ichart.1.1.min.js"></script>

	<script type="text/javascript">

/*
				var data = [
						{name : '总的订单数',value : 100, color:'red'},
						{name : '分配订单数',value : 30, color:'#3883bd'},
						{name : '拣货订单数',value : 26, color:'#3F5C71'},
						{name : '验货订单数',value : 10, color:'#a6bfd2'},
						{name : '发运订单数',value : 34, color:'#d6ffd2'}
					];
*/			

	var data;
	var total;

	window.setInterval(function() {
		Ajax({
			url : "http://localhost:9000/wmsx/rs/wms/kanban/104221",
			method : "GET",
			type : "json",
			ondata : function() { 
				data = eval(this.getResponseText());
				total = data[0].value;
				show();
			}
		});	  
	  }, 1000*30);



	function show() {
	  $(function(){
			new iChart.Column2D({
				render : 'canvasDiv2',
				data: data,
				title : '',
				// showpercent:true,
				decimalsnum:2,
				width : 800,
				height : 400,
				sub_option : {
					label : {
						fontsize:11,
						fontweight:600,
						color : '#4572a7'
					},
					border : {
						width : 2,
						radius : '5 5 0 0', //上圆角设置
						color : '#ffffff'
					}
				},
				coordinate:{
					background_color:'#fefefe',
					scale:[{
						 position:'left',	
						 start_scale:0,
						 end_scale:total,
						 scale_space:total/4
					}]
				}
			}).draw();
		});

		// data.splice(0, 1);
		$(function(){   
			var chart = new iChart.Pie2D({
				render : 'canvasDiv',
				title:{
					text:'仓库当天实时作业进度情况',
					color:'#e0e5e8',
					height:40,
					border:{
						enable:true,
						width:[0,0,2,0],
						color:'#343b3e'
					}
				},
				padding:'2 10',
				width : 800,
				height : 400,
				data:data,
				shadow:true,
				shadow_color:'#15353a',
				shadow_blur:8,
				background_color : '#3b4346',
				gradient:true, // 开启渐变
				color_factor:0.28,
				gradient_mode:'RadialGradientOutIn',
				showpercent:true,
				decimalsnum:2,
				legend:{
					enable:true,
					padding:30,
					color:'#e0e5e8',
					border:{
						width:[0,0,0,2],
						color:'#343b3e'
					},
					background_color : null,
				},
				sub_option:{
					border:{
						enable:false
					},
					label : {
						background_color:'#fefefe',
						sign:false, // 设置禁用label的小图标
						line_height:10,
						padding:4,
						border:{
							enable:true,
							radius : 4, // 圆角设置
							color:'#e0e5e8'
						},
						fontsize:11,
						fontweight:600,
						color : '#444444'
					},
					listeners:{
						parseText:function(d, t){
							return d.get('value');
						}
					}
				},
				border:{
					width:[0,20,0,20],
					color:'#1e2223'
				}
			});
			
			chart.bound(0);
			chart.bound(1);
			chart.bound(2);
			chart.bound(3);
		});
	}
	</script>
</head>

<body>
	<div id='canvasDiv'></div>
	<div id='canvasDiv2'></div>
</body>
</html>